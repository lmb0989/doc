<!doctype html>
<html lang="zh-CN" data-theme="light">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <meta name="generator" content="VuePress 2.0.0-rc.18" />
    <meta name="theme" content="VuePress Theme Hope 2.0.0-rc.59" />
    <style>
      :root {
        --vp-c-bg: #fff;
      }

      [data-theme="dark"] {
        --vp-c-bg: #1b1b1f;
      }

      html,
      body {
        background: var(--vp-c-bg);
      }
    </style>
    <script>
      const userMode = localStorage.getItem("vuepress-theme-hope-scheme");
      const systemDarkMode =
        window.matchMedia &&
        window.matchMedia("(prefers-color-scheme: dark)").matches;

      if (userMode === "dark" || (userMode !== "light" && systemDarkMode)) {
        document.documentElement.setAttribute("data-theme", "dark");
      }
    </script>
    <link rel="icon" href="/logo.png"><title>技术笔记</title><meta name="description" content="">
    <link rel="preload" href="/assets/style-Di_xg2Ac.css" as="style"><link rel="stylesheet" href="/assets/style-Di_xg2Ac.css">
    <link rel="modulepreload" href="/assets/app-Brvgr_Hz.js"><link rel="modulepreload" href="/assets/4.JSX脚本指南 - DOM篇.html-u0b-Bdgd.js"><link rel="modulepreload" href="/assets/plugin-vue_export-helper-DlAUqK2U.js">
    
  </head>
  <body>
    <div id="app"><!--[--><!--[--><!--[--><span tabindex="-1"></span><a href="#main-content" class="vp-skip-link sr-only">跳至主要內容</a><!--]--><!--[--><div class="theme-container external-link-icon has-toc" vp-container><!--[--><header id="navbar" class="vp-navbar" vp-navbar><div class="vp-navbar-start"><button type="button" class="vp-toggle-sidebar-button" title="Toggle Sidebar"><span class="icon"></span></button><!----><!--[--><a class="route-link vp-brand" href="/" aria-label="带我回家"><img class="vp-nav-logo" src="/logo.png" alt><!----><span class="vp-site-name hide-in-pad">技术笔记</span></a><!--]--><!----></div><div class="vp-navbar-center"><!----><!--[--><!----><!--]--><!----></div><div class="vp-navbar-end"><!----><!--[--><!----><!----><div class="vp-nav-item hide-in-mobile"><button type="button" class="vp-outlook-button" tabindex="-1" aria-hidden="true"><svg xmlns="http://www.w3.org/2000/svg" class="icon outlook-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="outlook icon" name="outlook"><path d="M224 800c0 9.6 3.2 44.8 6.4 54.4 6.4 48-48 76.8-48 76.8s80 41.6 147.2 0 134.4-134.4 38.4-195.2c-22.4-12.8-41.6-19.2-57.6-19.2C259.2 716.8 227.2 761.6 224 800zM560 675.2l-32 51.2c-51.2 51.2-83.2 32-83.2 32 25.6 67.2 0 112-12.8 128 25.6 6.4 51.2 9.6 80 9.6 54.4 0 102.4-9.6 150.4-32l0 0c3.2 0 3.2-3.2 3.2-3.2 22.4-16 12.8-35.2 6.4-44.8-9.6-12.8-12.8-25.6-12.8-41.6 0-54.4 60.8-99.2 137.6-99.2 6.4 0 12.8 0 22.4 0 12.8 0 38.4 9.6 48-25.6 0-3.2 0-3.2 3.2-6.4 0-3.2 3.2-6.4 3.2-6.4 6.4-16 6.4-16 6.4-19.2 9.6-35.2 16-73.6 16-115.2 0-105.6-41.6-198.4-108.8-268.8C704 396.8 560 675.2 560 675.2zM224 419.2c0-28.8 22.4-51.2 51.2-51.2 28.8 0 51.2 22.4 51.2 51.2 0 28.8-22.4 51.2-51.2 51.2C246.4 470.4 224 448 224 419.2zM320 284.8c0-22.4 19.2-41.6 41.6-41.6 22.4 0 41.6 19.2 41.6 41.6 0 22.4-19.2 41.6-41.6 41.6C339.2 326.4 320 307.2 320 284.8zM457.6 208c0-12.8 12.8-25.6 25.6-25.6 12.8 0 25.6 12.8 25.6 25.6 0 12.8-12.8 25.6-25.6 25.6C470.4 233.6 457.6 220.8 457.6 208zM128 505.6C128 592 153.6 672 201.6 736c28.8-60.8 112-60.8 124.8-60.8-16-51.2 16-99.2 16-99.2l316.8-422.4c-48-19.2-99.2-32-150.4-32C297.6 118.4 128 291.2 128 505.6zM764.8 86.4c-22.4 19.2-390.4 518.4-390.4 518.4-22.4 28.8-12.8 76.8 22.4 99.2l9.6 6.4c35.2 22.4 80 12.8 99.2-25.6 0 0 6.4-12.8 9.6-19.2 54.4-105.6 275.2-524.8 288-553.6 6.4-19.2-3.2-32-19.2-32C777.6 76.8 771.2 80 764.8 86.4z"></path></svg><div class="vp-outlook-dropdown"><!----></div></button></div><!--[--><button type="button" class="search-pro-button" aria-label="搜索"><svg xmlns="http://www.w3.org/2000/svg" class="icon search-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="search icon" name="search"><path d="M192 480a256 256 0 1 1 512 0 256 256 0 0 1-512 0m631.776 362.496-143.2-143.168A318.464 318.464 0 0 0 768 480c0-176.736-143.264-320-320-320S128 303.264 128 480s143.264 320 320 320a318.016 318.016 0 0 0 184.16-58.592l146.336 146.368c12.512 12.48 32.768 12.48 45.28 0 12.48-12.512 12.48-32.768 0-45.28"></path></svg><div class="search-pro-placeholder">搜索</div><div class="search-pro-key-hints"><kbd class="search-pro-key">Ctrl</kbd><kbd class="search-pro-key">K</kbd></div></button><!--]--><!--]--><!----><button type="button" class="vp-toggle-navbar-button" aria-label="Toggle Navbar" aria-expanded="false" aria-controls="nav-screen"><span><span class="vp-top"></span><span class="vp-middle"></span><span class="vp-bottom"></span></span></button></div></header><!----><!--]--><!----><div class="toggle-sidebar-wrapper"><span class="arrow start"></span></div><aside id="sidebar" class="vp-sidebar" vp-sidebar><!----><ul class="vp-sidebar-links"><li><section class="vp-sidebar-group"><button class="vp-sidebar-header clickable" type="button"><!----><span class="vp-sidebar-title">AI</span><span class="vp-arrow end"></span></button><!----></section></li><li><section class="vp-sidebar-group"><button class="vp-sidebar-header clickable" type="button"><!----><span class="vp-sidebar-title">Git</span><span class="vp-arrow end"></span></button><!----></section></li><li><section class="vp-sidebar-group"><button class="vp-sidebar-header clickable" type="button"><!----><span class="vp-sidebar-title">JavaScript</span><span class="vp-arrow end"></span></button><!----></section></li><li><section class="vp-sidebar-group"><button class="vp-sidebar-header clickable" type="button"><!----><span class="vp-sidebar-title">Jenkins</span><span class="vp-arrow end"></span></button><!----></section></li><li><section class="vp-sidebar-group"><button class="vp-sidebar-header clickable" type="button"><!----><span class="vp-sidebar-title">Linux</span><span class="vp-arrow end"></span></button><!----></section></li><li><section class="vp-sidebar-group"><button class="vp-sidebar-header clickable" type="button"><!----><span class="vp-sidebar-title">NodeJS</span><span class="vp-arrow end"></span></button><!----></section></li><li><section class="vp-sidebar-group"><button class="vp-sidebar-header clickable active" type="button"><!----><span class="vp-sidebar-title">PS插件开发</span><span class="vp-arrow down"></span></button><ul class="vp-sidebar-links"><li><section class="vp-sidebar-group"><button class="vp-sidebar-header clickable active" type="button"><!----><span class="vp-sidebar-title">CEP</span><span class="vp-arrow down"></span></button><ul class="vp-sidebar-links"><li><a class="route-link auto-link vp-sidebar-link" href="/Book/PS%E6%8F%92%E4%BB%B6%E5%BC%80%E5%8F%91/CEP/1.%E5%BC%80%E5%8F%91%E5%B7%A5%E5%85%B7.html" aria-label="1.开发工具"><!---->1.开发工具<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/Book/PS%E6%8F%92%E4%BB%B6%E5%BC%80%E5%8F%91/CEP/2.%E5%BF%AB%E9%80%9F%E5%BC%80%E5%A7%8B%EF%BC%88Hello%20World%EF%BC%89.html" aria-label="2.快速开始（Hello World）"><!---->2.快速开始（Hello World）<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/Book/PS%E6%8F%92%E4%BB%B6%E5%BC%80%E5%8F%91/CEP/3.%E8%B0%83%E8%AF%95Debug.html" aria-label="3.调试Debug"><!---->3.调试Debug<!----></a></li><li><a class="route-link route-link-active auto-link vp-sidebar-link active" href="/Book/PS%E6%8F%92%E4%BB%B6%E5%BC%80%E5%8F%91/CEP/4.JSX%E8%84%9A%E6%9C%AC%E6%8C%87%E5%8D%97%20-%20DOM%E7%AF%87.html" aria-label="4.JSX脚本指南 - DOM篇"><!---->4.JSX脚本指南 - DOM篇<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/Book/PS%E6%8F%92%E4%BB%B6%E5%BC%80%E5%8F%91/CEP/5.Action%20Manager%E4%BB%8E%E5%A5%BD%E5%A5%87%E5%88%B0%E5%8A%9D%E9%80%80%20-%20%E4%B8%8A%E7%AF%87.html" aria-label="5.Action Manager从好奇到劝退 - 上篇"><!---->5.Action Manager从好奇到劝退 - 上篇<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/Book/PS%E6%8F%92%E4%BB%B6%E5%BC%80%E5%8F%91/CEP/6.Action%20Manager%E4%BB%8E%E5%A5%BD%E5%A5%87%E5%88%B0%E5%8A%9D%E9%80%80%20-%20%E4%B8%AD%E7%AF%87.html" aria-label="6.Action Manager从好奇到劝退 - 中篇"><!---->6.Action Manager从好奇到劝退 - 中篇<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/Book/PS%E6%8F%92%E4%BB%B6%E5%BC%80%E5%8F%91/CEP/7.Action%20Manager%E4%BB%8E%E5%A5%BD%E5%A5%87%E5%88%B0%E5%8A%9D%E9%80%80%20-%20%E4%B8%8B%E7%AF%87.html" aria-label="7.Action Manager从好奇到劝退 - 下篇"><!---->7.Action Manager从好奇到劝退 - 下篇<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/Book/PS%E6%8F%92%E4%BB%B6%E5%BC%80%E5%8F%91/CEP/%E5%BC%95%E7%94%A8.html" aria-label="引用"><!---->引用<!----></a></li></ul></section></li></ul></section></li><li><section class="vp-sidebar-group"><button class="vp-sidebar-header clickable" type="button"><!----><span class="vp-sidebar-title">Python</span><span class="vp-arrow end"></span></button><!----></section></li><li><section class="vp-sidebar-group"><button class="vp-sidebar-header clickable" type="button"><!----><span class="vp-sidebar-title">TypeScript</span><span class="vp-arrow end"></span></button><!----></section></li><li><section class="vp-sidebar-group"><button class="vp-sidebar-header clickable" type="button"><!----><span class="vp-sidebar-title">doc</span><span class="vp-arrow end"></span></button><!----></section></li><li><section class="vp-sidebar-group"><button class="vp-sidebar-header clickable" type="button"><!----><span class="vp-sidebar-title">其他</span><span class="vp-arrow end"></span></button><!----></section></li><li><section class="vp-sidebar-group"><button class="vp-sidebar-header clickable" type="button"><!----><span class="vp-sidebar-title">加密技术</span><span class="vp-arrow end"></span></button><!----></section></li><li><section class="vp-sidebar-group"><button class="vp-sidebar-header clickable" type="button"><!----><span class="vp-sidebar-title">学习资料</span><span class="vp-arrow end"></span></button><!----></section></li><li><section class="vp-sidebar-group"><button class="vp-sidebar-header clickable" type="button"><!----><span class="vp-sidebar-title">工具</span><span class="vp-arrow end"></span></button><!----></section></li><li><section class="vp-sidebar-group"><button class="vp-sidebar-header clickable" type="button"><!----><span class="vp-sidebar-title">数据库</span><span class="vp-arrow end"></span></button><!----></section></li><li><section class="vp-sidebar-group"><button class="vp-sidebar-header clickable" type="button"><!----><span class="vp-sidebar-title">构建工具</span><span class="vp-arrow end"></span></button><!----></section></li><li><section class="vp-sidebar-group"><button class="vp-sidebar-header clickable" type="button"><!----><span class="vp-sidebar-title">正则表达式</span><span class="vp-arrow end"></span></button><!----></section></li><li><section class="vp-sidebar-group"><button class="vp-sidebar-header clickable" type="button"><!----><span class="vp-sidebar-title">游戏</span><span class="vp-arrow end"></span></button><!----></section></li><li><section class="vp-sidebar-group"><button class="vp-sidebar-header clickable" type="button"><!----><span class="vp-sidebar-title">网络</span><span class="vp-arrow end"></span></button><!----></section></li><li><section class="vp-sidebar-group"><button class="vp-sidebar-header clickable" type="button"><!----><span class="vp-sidebar-title">部署集成</span><span class="vp-arrow end"></span></button><!----></section></li></ul><!----></aside><!--[--><main id="main-content" class="vp-page"><!--[--><!----><!----><nav class="vp-breadcrumb disable"></nav><div class="vp-page-title"><h1><!----></h1><div class="page-info"><!----><!----><span class="page-date-info" aria-label="写作日期📅" data-balloon-pos="up"><svg xmlns="http://www.w3.org/2000/svg" class="icon calendar-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="calendar icon" name="calendar"><path d="M716.4 110.137c0-18.753-14.72-33.473-33.472-33.473-18.753 0-33.473 14.72-33.473 33.473v33.473h66.993v-33.473zm-334.87 0c0-18.753-14.72-33.473-33.473-33.473s-33.52 14.72-33.52 33.473v33.473h66.993v-33.473zm468.81 33.52H716.4v100.465c0 18.753-14.72 33.473-33.472 33.473a33.145 33.145 0 01-33.473-33.473V143.657H381.53v100.465c0 18.753-14.72 33.473-33.473 33.473a33.145 33.145 0 01-33.473-33.473V143.657H180.6A134.314 134.314 0 0046.66 277.595v535.756A134.314 134.314 0 00180.6 947.289h669.74a134.36 134.36 0 00133.94-133.938V277.595a134.314 134.314 0 00-133.94-133.938zm33.473 267.877H147.126a33.145 33.145 0 01-33.473-33.473c0-18.752 14.72-33.473 33.473-33.473h736.687c18.752 0 33.472 14.72 33.472 33.473a33.145 33.145 0 01-33.472 33.473z"></path></svg><span data-allow-mismatch="text">2025年3月18日</span><meta property="datePublished" content="2025-03-18T08:11:06.000Z"></span><!----><span class="page-reading-time-info" aria-label="阅读时间⌛" data-balloon-pos="up"><svg xmlns="http://www.w3.org/2000/svg" class="icon timer-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="timer icon" name="timer"><path d="M799.387 122.15c4.402-2.978 7.38-7.897 7.38-13.463v-1.165c0-8.933-7.38-16.312-16.312-16.312H256.33c-8.933 0-16.311 7.38-16.311 16.312v1.165c0 5.825 2.977 10.874 7.637 13.592 4.143 194.44 97.22 354.963 220.201 392.763-122.204 37.542-214.893 196.511-220.2 389.397-4.661 5.049-7.638 11.651-7.638 19.03v5.825h566.49v-5.825c0-7.379-2.849-13.981-7.509-18.9-5.049-193.016-97.867-351.985-220.2-389.527 123.24-37.67 216.446-198.453 220.588-392.892zM531.16 450.445v352.632c117.674 1.553 211.787 40.778 211.787 88.676H304.097c0-48.286 95.149-87.382 213.728-88.676V450.445c-93.077-3.107-167.901-81.297-167.901-177.093 0-8.803 6.99-15.793 15.793-15.793 8.803 0 15.794 6.99 15.794 15.793 0 80.261 63.69 145.635 142.01 145.635s142.011-65.374 142.011-145.635c0-8.803 6.99-15.793 15.794-15.793s15.793 6.99 15.793 15.793c0 95.019-73.789 172.82-165.96 177.093z"></path></svg><span>大约 22 分钟</span><meta property="timeRequired" content="PT22M"></span><!----><!----></div><hr></div><div class="vp-toc-placeholder"><aside id="toc" vp-toc><!----><div class="vp-toc-header">此页内容<button type="button" class="print-button" title="打印"><svg xmlns="http://www.w3.org/2000/svg" class="icon print-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="print icon" name="print"><path d="M819.2 364.8h-44.8V128c0-17.067-14.933-32-32-32H281.6c-17.067 0-32 14.933-32 32v236.8h-44.8C145.067 364.8 96 413.867 96 473.6v192c0 59.733 49.067 108.8 108.8 108.8h44.8V896c0 17.067 14.933 32 32 32h460.8c17.067 0 32-14.933 32-32V774.4h44.8c59.733 0 108.8-49.067 108.8-108.8v-192c0-59.733-49.067-108.8-108.8-108.8zM313.6 160h396.8v204.8H313.6V160zm396.8 704H313.6V620.8h396.8V864zM864 665.6c0 25.6-19.2 44.8-44.8 44.8h-44.8V588.8c0-17.067-14.933-32-32-32H281.6c-17.067 0-32 14.933-32 32v121.6h-44.8c-25.6 0-44.8-19.2-44.8-44.8v-192c0-25.6 19.2-44.8 44.8-44.8h614.4c25.6 0 44.8 19.2 44.8 44.8v192z"></path></svg></button><div class="arrow end"></div></div><div class="vp-toc-wrapper"><ul class="vp-toc-list"><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#extendscript语言">ExtendScript语言</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#脚本dom编程">脚本DOM编程</a></li><li><ul class="vp-toc-list"><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#_1-图层操作">1. 图层操作</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#_2-属性操作">2. 属性操作</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#_3-单位">3. 单位</a></li><!----><!--]--></ul></li><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#内置对象">内置对象</a></li><li><ul class="vp-toc-list"><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#_1-对象">1. $对象</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#_2-文件引用">2. 文件引用</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#_3-文件系统">3. 文件系统</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#_4-xml解析">4. XML解析</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#_5-其它">5. 其它</a></li><!----><!--]--></ul></li><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#总结">总结</a></li><!----><!--]--></ul><div class="vp-toc-marker" style="top:-1.7rem;"></div></div><!----></aside></div><!----><div class="theme-hope-content" vp-content><h2 id="extendscript语言" tabindex="-1"><a class="header-anchor" href="#extendscript语言"><span>ExtendScript语言</span></a></h2><p>下面是Adobe官方给出的一段针对这个语言的介绍</p><blockquote><p>”[…] an extended form of JavaScript used by several Adobe applications, including Photoshop, Illustrator, and InDesign. ExtendScript implements the JavaScript language according to the ECMA-262 specification. [It] supports the 3rd Edition of the ECMA-262 Standard, including its notational and lexical conventions, types, objects, expressions, and statements. ExtendScript also implements the E4X ECMA-357 specification, which defines access to data in XML format.”</p></blockquote><p>从里面我们就可以看到，JSX采用的ES3标准，是一套非常非常非常旧的语言集合，我们目前基于chrome的web开发，一般都用到了ES6的标准，那是差的不是一两个时代，你不能在JSX里头使用各种新的语言特性，比如<strong>let</strong>, <strong>const</strong>, <strong>箭头函数</strong> 等等，这些在里面都跑不起来，你只能一路<strong>var</strong>到底，同时有一些你平常习惯了的函数可能也没有，比如</p><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" data-title="" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span>Array.indexOf() // JSX的Array对象里头并没有indexOf函数</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>针对这种场景，你可以自己做一些Array的扩展，或者就是乖乖的用for去遍历。</p><p>不过虽然如此，借助整个web繁荣的生态，我们依然可以用最新的语言集合来编码，然后通过编译工具生成目标语言，比如我自己日常开发，就喜欢用<strong>Typescript</strong>来开发，然后通过webpack/ts编译、混淆、打包然后在进行发布，这个部分对web开发的前端同学应该都很熟悉，我就不展开介绍了。教程后面的篇章，会讲插件的打包，混淆，发布相关，会在介绍这块内容。</p><figure><a href="https://blog.cutterman.cn/assets/gallery/contents/Snip20211128_1.png" target="_blank" rel="noopener noreferrer"><img src="/assets/Snip20211128_1-B332JGe8.png" alt="Typescript" tabindex="0" loading="lazy"></a><figcaption>Typescript</figcaption></figure><p><a href="https://blog.cutterman.cn/assets/gallery/contents/Snip20211128_1.png" target="_blank" rel="noopener noreferrer">Typescript</a></p><h2 id="脚本dom编程" tabindex="-1"><a class="header-anchor" href="#脚本dom编程"><span>脚本DOM编程</span></a></h2><p>大多数涉及到脚本插件开发的小伙伴，都会从官方那里找到<strong>photoshop-cc-javascript-ref.pdf</strong>这样的参考文档，这也是插件开发所能找到的最全，最完整的官方参考资料了…</p><figure><a href="https://blog.cutterman.cn/assets/gallery/contents/Snip20211128_2.png" target="_blank" rel="noopener noreferrer"><img src="/assets/Snip20211128_2-Dv372V6u.png" alt="photoshop cc javascript reference" tabindex="0" loading="lazy"></a><figcaption>photoshop cc javascript reference</figcaption></figure><p><a href="https://blog.cutterman.cn/assets/gallery/contents/Snip20211128_2.png" target="_blank" rel="noopener noreferrer">photoshop cc javascript reference</a></p><p>从这个文档里头，我们找到可以针对Ps编程需要的一些接口Api，使用方法，注意事项等。而它价值最大的是给与开发着一张编程图谱：即宿主可操控对象的DOM树。对于前端开发着而言，经常面对的是HTML的DOM树，看到Ps的这个DOM树结构，也应该非常适应，我对这个DOM树做了一些归类，如下图</p><figure><a href="https://blog.cutterman.cn/assets/gallery/contents/Photoshop.png" target="_blank" rel="noopener noreferrer"><img src="/assets/Photoshop-DvA2lCDP.png" alt="photoshop dom tree" tabindex="0" loading="lazy"></a><figcaption>photoshop dom tree</figcaption></figure><p><a href="https://blog.cutterman.cn/assets/gallery/contents/Photoshop.png" target="_blank" rel="noopener noreferrer">photoshop dom tree</a></p><p>然后文档也告诉我们DOM的顶级层级是<strong>app</strong>，一切都可以通过它开始</p><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" data-title="" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span>var doc = app.activeDocument; // 获取当前文档</span></span>
<span class="line"><span>var layer = app.activeDocument.activeLayer;  // 获取当前选中的图层</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div><p>其中<strong>app</strong>是一切的入口，同时它又是默认值，可以缺省，即</p><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" data-title="" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span>var doc = activeDocument; </span></span>
<span class="line"><span>var layer = activeDocument.activeLayer;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div><p>通过文档中的接口，我们可以通过<strong>Layers/Layer</strong>来操作图层相关的内容，通过<strong>Guides</strong>来操作参考线，<strong>PathItems</strong>操作路径等内容，具体每个对象具备的接口和使用方法，文档当中都有，我这里就不一一介绍了，下面通过几个示例，讲述其中的一些需要注意的点</p><h3 id="_1-图层操作" tabindex="-1"><a class="header-anchor" href="#_1-图层操作"><span>1. 图层操作</span></a></h3><p>涉及到图层相关的对象有ArtLayer/ArtLayers/Layers/LayerSet/LayerSets，其中ArtLayer是一般图层，区别于LayerSet是图层组，ArtLayers/LayerSets分别是一般图层和图层的集合，即包含了一堆这样的图层</p><figure><a href="https://blog.cutterman.cn/assets/gallery/contents/Snip20211128_3.png" target="_blank" rel="noopener noreferrer"><img src="/assets/Snip20211128_3-BAJm8FEM.png" alt="ArtLayer &amp; LayerSet " tabindex="0" loading="lazy"></a><figcaption>ArtLayer &amp; LayerSet </figcaption></figure><p><a href="https://blog.cutterman.cn/assets/gallery/contents/Snip20211128_3.png" target="_blank" rel="noopener noreferrer">ArtLayer &amp; LayerSet</a></p><p>而Layers是图层统称，即可以是ArtLayer，也可以是LayerSet， 所以通常我们不知道图层里头都是哪些的时候，就可以用Layers，下面的例子我们遍历document的<strong>一级图层</strong>打印图层信息</p><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" data-title="" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span>var layers = app.activeDocument.layers;</span></span>
<span class="line"><span>for (var i=0; i&lt;layers.length; i++) {</span></span>
<span class="line"><span>    var layer = layers[i];</span></span>
<span class="line"><span>    $.writeln(&quot;doc.layers[&quot; + i + &quot;] &quot; + layer.name + &quot;. id: &quot; + layer.id + &quot;. itemIndex: &quot; + layer.itemIndex);</span></span>
<span class="line"><span>}</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>上面的例子，有一个<strong>非常重要</strong>的地方要记住，它不是遍历当前文档中的所有图层，而是只会输出图层面板上的一级图层。我们知道Ps的图层结构，层级是可以不断深入的，所以这里就有了层级的概念，每次Layers都只能遍历当前层级的第一个子层级列表。</p><figure><a href="https://blog.cutterman.cn/assets/gallery/contents/Snip20211128_5.png" target="_blank" rel="noopener noreferrer"><img src="/assets/Snip20211128_5-72v-Yrij.png" alt="ArtLayer &amp; LayerSet " tabindex="0" loading="lazy"></a><figcaption>ArtLayer &amp; LayerSet </figcaption></figure><p><a href="https://blog.cutterman.cn/assets/gallery/contents/Snip20211128_5.png" target="_blank" rel="noopener noreferrer">ArtLayer &amp; LayerSet</a></p><p>所以要遍历所有图层，我们就需要判断当前图层是否是图层组（LayerSet），如果是图层组，意味着里头还有图层，如此反复。通常我们用递归的方法来完成这样的操作：</p><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" data-title="" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span>// 递归方式遍历文档中的所有图层</span></span>
<span class="line"><span>function loopLayers(layers) {</span></span>
<span class="line"><span>    for (var i=0; i&lt;layers.length; i++) {</span></span>
<span class="line"><span>        var layer = layers[i];</span></span>
<span class="line"><span>        $.writeln(&quot;doc.layers[&quot; + i + &quot;] &quot; + layer.name + &quot;. id: &quot; + layer.id + &quot;. itemIndex: &quot; + layer.itemIndex);</span></span>
<span class="line"><span>        if (layer.typename == &quot;LayerSet&quot;) { // 如果当前图层是图层组，就遍历它里头的图层</span></span>
<span class="line"><span>            loopLayers(layer.layers);</span></span>
<span class="line"><span>        }</span></span>
<span class="line"><span>    }</span></span>
<span class="line"><span>}</span></span>
<span class="line"><span>loopLayers(activeDocument.layers);</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>通过上面的代码我们可以递归遍历文档中的所有图层，并拿到想要的信息，不过你会发现当文档图层很多，嵌套很深的时候，这个方式会很慢，后面我会介绍更快的办法，暂时……先这样。下面我给了一个图层列表，通过上面的代码进行测试，可以看到结果如下</p><figure><a href="https://blog.cutterman.cn/assets/gallery/contents/Snip20211128_6.png" target="_blank" rel="noopener noreferrer"><img src="/assets/Snip20211128_6-BkwUYauE.png" alt="loop layers" tabindex="0" loading="lazy"></a><figcaption>loop layers</figcaption></figure><p><a href="https://blog.cutterman.cn/assets/gallery/contents/Snip20211128_6.png" target="_blank" rel="noopener noreferrer">loop layers</a></p><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" data-title="" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span>doc.layers[0] Layer 5. id: 8. itemIndex: 8</span></span>
<span class="line"><span>doc.layers[1] Group 1. id: 6. itemIndex: 7</span></span>
<span class="line"><span>doc.layers[0] Layer 4. id: 5. itemIndex: 6</span></span>
<span class="line"><span>doc.layers[1] Layer 3. id: 4. itemIndex: 5</span></span>
<span class="line"><span>doc.layers[2] Layer 2. id: 3. itemIndex: 3</span></span>
<span class="line"><span>doc.layers[3] Layer 1. id: 2. itemIndex: 2</span></span>
<span class="line"><span>doc.layers[4] Background. id: 1. itemIndex: 1</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>从上面的输出结果，我们可以看到如下几个特征：</p><ol><li><p>虽然图层是有层级的，但是他们的index却是一维的，图层位于越上面的，index值越大，在视觉层面，它就会盖住下面的图层，这个和HTML/CSS中的z-index类似</p></li><li><p>如果你调整了一些图层的顺序再执行上面的代码，会发现对于图层的调整而言，图层的ID是不会发生变化的，但是它的index会做相应的调整，来保证视觉顺序</p><figure><img src="/assets/Snip20211128_7-CbCOPet1.png" alt="layer adjustment" tabindex="0" loading="lazy"><figcaption>layer adjustment</figcaption></figure><p>layer adjustment</p><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" data-title="" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span>doc.layers[0] Layer 2. id: 3. itemIndex: 8</span></span>
<span class="line"><span>doc.layers[1] Layer 1. id: 2. itemIndex: 7</span></span>
<span class="line"><span>doc.layers[2] Group 1. id: 6. itemIndex: 6</span></span>
<span class="line"><span>doc.layers[0] Layer 4. id: 5. itemIndex: 5</span></span>
<span class="line"><span>doc.layers[1] Layer 3. id: 4. itemIndex: 4</span></span>
<span class="line"><span>doc.layers[3] Layer 5. id: 8. itemIndex: 2</span></span>
<span class="line"><span>doc.layers[4] Background. id: 1. itemIndex: 1</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li><li><p>如果你仔细观察输出的结果，你会发现index里头少了<strong>3</strong>，id里头少了<strong>7</strong>，这是为什么呢？这是因为当你新建了一个图层组的时候，Ps在后面预留了一个图层index，这个预留的值会在你拖动图层到图层组的时候派上用场，比如你可以把一个图层移动到图层组的里面，外面，末尾的位置等等，都是通过这个预留的图层索引来操作的。这块内容，我们在后面讲动作管理器的时候还会提到。至于在DOM下，你要增加一个图层非常简单，不用关心这个隐藏的索引数值</p></li></ol><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" data-title="" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span>// 给某个图层组添加一个图层</span></span>
<span class="line"><span>var layerSet = activeDocument.layerSets[0];</span></span>
<span class="line"><span>var layer = layerSet.artLayers.add();</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_2-属性操作" tabindex="-1"><a class="header-anchor" href="#_2-属性操作"><span>2. 属性操作</span></a></h3><p>从官方文档里头，我们可以看到对象提供了许多方法(methods)和属性(properties)，对于属性，我们有一个特别注意的地方是，有些属性是可以改的，有些是不能的</p><figure><a href="https://blog.cutterman.cn/assets/gallery/contents/Snip20211128_8.png" target="_blank" rel="noopener noreferrer"><img src="/assets/Snip20211128_8-CeAGZfpP.png" alt="properties read write" tabindex="0" loading="lazy"></a><figcaption>properties read write</figcaption></figure><p><a href="https://blog.cutterman.cn/assets/gallery/contents/Snip20211128_8.png" target="_blank" rel="noopener noreferrer">properties read write</a></p><p>只有那些Read-Write的属性，你才可以设置它，比如你可以通过修改name属性来设置一个图层的名称，但是你不能通过设置typename来把一个普通图层改成图层组</p><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" data-title="" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span>var layerSet = activeDocument.layerSets[0];</span></span>
<span class="line"><span>var layer = layerSet.artLayers.add();</span></span>
<span class="line"><span>layer.name = &quot;an awesome name&quot;;     // 可以设置名称</span></span>
<span class="line"><span>// 这样是不可以的</span></span>
<span class="line"><span>layer.typename = &quot;LayerSet&quot;;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_3-单位" tabindex="-1"><a class="header-anchor" href="#_3-单位"><span>3. 单位</span></a></h3><p>Ps提供了多种尺寸单位：像素/毫米/厘米/英寸等（可以在首选项-&gt;标尺&amp;单位里头找到），它适用在不同的场景当中，当你要操作文档的时候，如果不进行设置，它就会采用当前用户使用的单位，这个往往会和你的预期不符，我们在脚本开发的时候，尤其需要注意这个，只要涉及到尺寸，距离相关的计算，都要考虑到这里。</p><figure><a href="https://blog.cutterman.cn/assets/gallery/contents/Snip20211128_9.png" target="_blank" rel="noopener noreferrer"><img src="/assets/Snip20211128_9-C0iaNp-q.png" alt="Units &amp; Rulers" tabindex="0" loading="lazy"></a><figcaption>Units &amp; Rulers</figcaption></figure><p><a href="https://blog.cutterman.cn/assets/gallery/contents/Snip20211128_9.png" target="_blank" rel="noopener noreferrer">Units &amp; Rulers</a></p><p>脚本提供了一个叫<strong>UnitValue</strong>的对象来包装所有的单位处理，你还可以通过该对象提供的<strong>as</strong>, <strong>convert</strong>两个方法来做单位的转换，具体使用参考官方的<strong>Javascript-Tools-Guide-CC.pdf</strong>文档</p><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" data-title="" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span>new UnitValue(70, &quot;px&quot;);    // 表示70像素</span></span>
<span class="line"><span>new UnitValue(10, &quot;in&quot;);    // 表示10英寸</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div><p>由于单位的设置是在首选项里头进行的，前面我们看到API提供了首选项<strong>Preference</strong>的操作，于是我们可以通过设置首选项对应的值来修改默认的单位，这个在我们脚本编程的时候非常重要。又我们的代码执行完之后，还应该把用户原来的设置还原回去</p><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" data-title="" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span>// 先把用户原来的单位设置保存起来</span></span>
<span class="line"><span>var rulerUnit = preferences.rulerUnits;</span></span>
<span class="line"><span>var typeUnit = preferences.typeUnits;</span></span>
<span class="line"><span></span></span>
<span class="line"><span>// 把默认单位都设置成像素</span></span>
<span class="line"><span>preferences.rulerUnits = Units.PIXELS;</span></span>
<span class="line"><span>preferences.typeUnits = TypeUnits.PIXELS;</span></span>
<span class="line"><span></span></span>
<span class="line"><span>// 执行你的代码...</span></span>
<span class="line"><span></span></span>
<span class="line"><span>// 最后把用户的值还原回去</span></span>
<span class="line"><span>preferences.rulerUnits = rulerUnit;</span></span>
<span class="line"><span>preferences.typeUnits = typeUnit;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="内置对象" tabindex="-1"><a class="header-anchor" href="#内置对象"><span>内置对象</span></a></h2><p>JSX核心除了提供给我们一个DOM树之外，还提供了一些内置对象来完成一些其它操作</p><h3 id="_1-对象" tabindex="-1"><a class="header-anchor" href="#_1-对象"><span>1. $对象</span></a></h3><p>$ 是一个全局对象，它提供了一些属性和方法，在某些场景你可能用得上</p><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" data-title="" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span>// 0: No debugging</span></span>
<span class="line"><span>// 1: Break on runtime errors // 2: Full debug mode $.level;</span></span>
<span class="line"><span>// String. The current File Name: works only if it&#39;s been saved once // Won&#39;t work in the context of HTML Panels</span></span>
<span class="line"><span>$.fileName;</span></span>
<span class="line"><span>// Object. The Global namespace.</span></span>
<span class="line"><span>$.global;</span></span>
<span class="line"><span>// String. The current locale (e.g. &quot;en_US&quot;). It&#39;s Read-Write, so you can // change the locale of your scripts on the fly to test different languages $.locale;</span></span>
<span class="line"><span>// String. In my machine, &quot; Macintosh OS 10.12.0/64&quot;</span></span>
<span class="line"><span>$.os;</span></span>
<span class="line"><span>// The current Stack trace</span></span>
<span class="line"><span>$.stack;</span></span>
<span class="line"><span>// The line where the $.line itself is found</span></span>
<span class="line"><span>$.line;</span></span>
<span class="line"><span></span></span>
<span class="line"><span>//    ---------------------</span></span>
<span class="line"><span>// ===       METHODS       ===</span></span>
<span class="line"><span>//    ---------------------</span></span>
<span class="line"><span>// Write a String, without or with a linefeed $.write(&quot;Hello World!&quot;); // no LF $.writeln(&quot;Ciao Mondo!&quot;); // with LF</span></span>
<span class="line"><span>// Evaluates the ExtendScript code from a file that loads from a path, // provided as a string, and returns the result of the evaluation $.evalFile(&quot;~/Desktop/TEMP/foobarbazprr.jsx&quot;);</span></span>
<span class="line"><span>// Pauses for n milliseconds. Mind you: not equivalent to JavaScript setTimeout()</span></span>
<span class="line"><span>$.sleep(4000);</span></span>
<span class="line"><span>// Runs the garbage collection</span></span>
<span class="line"><span>$.gc();</span></span>
<span class="line"><span>// Set and Get Environment Vars</span></span>
<span class="line"><span>// Useful when you need, say, PS and Bridge to share variables $.setenv(&quot;HotFolder&quot;, &quot;~/Desktop/TEMP&quot;); $.getenv(&quot;HotFolder&quot;); // &quot;~/Desktop/TEMP&quot;</span></span>
<span class="line"><span>// Set a breakpoint</span></span>
<span class="line"><span>$.bp();</span></span>
<span class="line"><span>debugger; // can be used as well within the code</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_2-文件引用" tabindex="-1"><a class="header-anchor" href="#_2-文件引用"><span>2. 文件引用</span></a></h3><p>当你的JSX文件很多的时候，如果进行文件引用会成为一个问题，通常，我们会在插件加载的时候，把这些jsx都加载进来，但是也还有另外一种方法，系统提供另一个#include指令，通过它我们可以引用其它JSX文件</p><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" data-title="" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span>// in main.jsx</span></span>
<span class="line"><span>#include &quot;tools.jsx&quot; </span></span>
<span class="line"><span></span></span>
<span class="line"><span>// ...</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_3-文件系统" tabindex="-1"><a class="header-anchor" href="#_3-文件系统"><span>3. 文件系统</span></a></h3><p>宿主给我们提供了File/Folder两个对象，通过它我们可以操作本地系统的文件和文件夹，当我们需要做一些持久化存储的时候，或者从本地读取/存储一些文件的时候，就会用到这些对象的方法</p><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" data-title="" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span>var folder = new Folder(&#39;~/Desktop/&#39;);</span></span>
<span class="line"><span>$.writeln(folder.absolutePath);</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div><p>相关的API大家看文档就可以了，后续篇章会有讲持久化存储的，还会再讲到这里</p><h3 id="_4-xml解析" tabindex="-1"><a class="header-anchor" href="#_4-xml解析"><span>4. XML解析</span></a></h3><p>通过提供的XML对象，我们可以比较方便的解析xml格式文件，虽然这种格式目前用的比较少了</p><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" data-title="" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span>/*</span></span>
<span class="line"><span> * demo.xml</span></span>
<span class="line"><span> * &lt;root&gt;</span></span>
<span class="line"><span> *    &lt;item&gt;value&lt;/item&gt;</span></span>
<span class="line"><span> * &lt;/root&gt;</span></span>
<span class="line"><span> */</span></span>
<span class="line"><span>var file = new File(&quot;~/Desktop/demo.xml&quot;);</span></span>
<span class="line"><span>file.open(&quot;r&quot;);</span></span>
<span class="line"><span>var content = file.read();</span></span>
<span class="line"><span>file.close();</span></span>
<span class="line"><span>// 创建一个xml对象</span></span>
<span class="line"><span>var xmlObj = new XML(content); </span></span>
<span class="line"><span>xmlObj.children().length; // 1</span></span>
<span class="line"><span>xmlObj.root[0].item;  // value</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_5-其它" tabindex="-1"><a class="header-anchor" href="#_5-其它"><span>5. 其它</span></a></h3><p>还有一些Socket, XMP, Localization等内置对象，一般用的都比较少，我就不再一一介绍了，感兴趣的查看官方文档即可。</p><h2 id="总结" tabindex="-1"><a class="header-anchor" href="#总结"><span>总结</span></a></h2><p>本文主要介绍了JSX的核心，通过官方给出的文档给大家做一个初步的介绍，并且介绍了DOM的基本概念和一些使用问题，通过DOM提供的API，我们可以对宿主做一些基本操作，比如创建图层，查找图层等。</p><p>本文介绍所涉及到的官方文档，我这里弄了一份，有需要的可以直接下载使用</p><p><a href="https://blog.cutterman.cn/assets/files/JavaScript-Tools-Guide-CC.pdf" target="_blank" rel="noopener noreferrer">JavaScript-Tools-Guide-CC.pdf</a></p><p><a href="https://blog.cutterman.cn/assets/files/JavaScript-Tools-Guide-CC.pdf" target="_blank" rel="noopener noreferrer">photoshop-cc-javascript-ref.pdf</a></p><p><a href="https://blog.cutterman.cn/assets/files/photoshop-cc-javascript-ref.pdf" target="_blank" rel="noopener noreferrer">photoshop-cc-scripting-guide-2015.pdf</a></p><p>但是，你很容易就会发现，DOM提供的API太少了，能力非常有限，比如你可以通过名称来查找图层<strong>getByName</strong>，但是它只能在第一个子图层层级用，并且图层名称是可以重复的，这样你就很难找到唯一的某个图层。在比如<strong>activeLayer</strong>返回当前选中的图层，但是如果你选中了多个图层，它只能返回第一个，那我怎么拿到选中的图层列表呢？还有很多很多其它的操作，你会发现DOM里头都没有，大多数时候，你只依赖DOM提供的API，是完不成一件完整的事情的。</p><p>那怎么办呢？ 这就要涉及到我们下一篇要讲的<strong>Action Manager</strong>，也叫动作管理器，它是Photoshop提供的一种俗称<strong>黑魔法</strong>的东西，通过它，我们可以做更多的事情</p></div><!----><footer class="vp-page-meta"><!----><div class="vp-meta-item git-info"><div class="update-time"><span class="vp-meta-label">上次编辑于: </span><span class="vp-meta-info" data-allow-mismatch="text">2025/3/18 08:11:06</span></div><div class="contributors"><span class="vp-meta-label">贡献者: </span><!--[--><!--[--><span class="vp-meta-info" title="email: 1150274785@qq.com">lmb0989</span><!--]--><!--]--></div></div></footer><nav class="vp-page-nav"><a class="route-link auto-link prev" href="/Book/PS%E6%8F%92%E4%BB%B6%E5%BC%80%E5%8F%91/CEP/3.%E8%B0%83%E8%AF%95Debug.html" aria-label="3.调试Debug"><div class="hint"><span class="arrow start"></span>上一页</div><div class="link"><!---->3.调试Debug</div></a><a class="route-link auto-link next" href="/Book/PS%E6%8F%92%E4%BB%B6%E5%BC%80%E5%8F%91/CEP/5.Action%20Manager%E4%BB%8E%E5%A5%BD%E5%A5%87%E5%88%B0%E5%8A%9D%E9%80%80%20-%20%E4%B8%8A%E7%AF%87.html" aria-label="5.Action Manager从好奇到劝退 - 上篇"><div class="hint">下一页<span class="arrow end"></span></div><div class="link">5.Action Manager从好奇到劝退 - 上篇<!----></div></a></nav><!----><!----><!--]--></main><!--]--><!----></div><!--]--><!--]--><!--[--><!----><!--[--><!--]--><!----><!--]--><!--]--></div>
    <script type="module" src="/assets/app-Brvgr_Hz.js" defer></script>
  </body>
</html>
